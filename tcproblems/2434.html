<html>
<head>
<title>Â Problem Statement for TablePartitions</title>
</head>
<body>
<table border="0" cellspacing="0" cellpadding="10" width="100%">
           <tr>
             <td valign="top" width="100%"><img src="/i/clear.gif" alt="" width="240" height="1" border="0"><br>
               <table border="0" cellspacing="0" cellpadding="0" width="100%">
                 <tr>
                   <td colspan="7"><img src="/i/clear.gif" alt="" width="1" height="1" border="0"></td>
                 </tr>
                 <tr>
                   <td colspan="7"><img src="/i/clear.gif" alt="" width="1" height="5" border="0"></td>
                 </tr>
                 <tr>
                   
                     <td background="/i/steel_gray_bg.gif" class="statTextBig" colspan="7" height="18">&#160;Problem Statement for TablePartitions</td>
                   
                 </tr>
                 <tr>
                   <td colspan="7"><img src="/i/clear.gif" alt="" width="1" height="1" border="0"></td>
                 </tr>
                 <tr>
                   <td colspan="7"><img src="/i/clear.gif" alt="" width="1" height="1" border="0"></td>
                 </tr>
                 <tr>
                   <td class="problemText" valign="middle" align="left">
                      
              		<table><tr><td colspan="2" class="statText"><h3>Problem Statement</h3></td></tr><tr><td class="statText">&#160;&#160;&#160;&#160;</td><td class="statText"><p>
A table in a database consists of rows and columns. Rows correspond
to elements in the table, and columns correspond to fields in the elements.
In this problem we will only deal with elements that have integer fields
in the range 0 to 100, inclusive.
The columns will be named sequentially with lower case letters, starting with 'a', then
'b' and so on. So an element in a table with 4 columns may be described like this: &quot;a=3, b=10, c=15, d=0&quot;.
Note that all fields in an element must contain an integer value in the valid range,
i.e. no field may be omitted.
</p>

<p>
A large table in a database can be a performance hog. One way
to avoid this is to logically partition the table
into several smaller tables. This is done by giving each partition a set of constraints
on the columns, specifying which rows in the large table should go
to which partition.
</p>

<p>
Given the constraints for the partitions of a table, write a class that
determines whether the partitions are <i>well formed</i> (see below). The
constraints will be given as a String[] where each
element corresponds to one partition. Each element contains a
space separated list of constraints, where each constraint is
in the form &quot;&lt;column&gt;&lt;operator&gt;&lt;value&gt;&quot; (quotes for clarity only)
where &lt;column&gt; is a table column, &lt;operator&gt; is one of
the relational operators '=', '&lt;', '&gt;', '&lt;=', '&gt;=', and &lt;value&gt; is
an integer between 0 and 100, inclusive (without leading zeros). The constraints
for each partition represents a conjunction, i.e. all constraints must hold (see example 1).
</p>

<p>
For instance, if we have 3 partitions and a table with 2 columns,
the constraints might look like this: {&quot;a&gt;3&quot;, &quot;a&lt;=3 b&gt;5&quot;, &quot;b&lt;6 a&lt;=3&quot;}.
Element &quot;a=4, b=3&quot; would then go to the first partition, element &quot;a=3, b=9&quot; would
go to the second partition and element &quot;a=0, b=5&quot; would go to the third partition.
</p>

<p>
The partitioning is badly constructed if one or more of the criteria below holds:
</p>

<ul>
<li><i>Empty partition</i>: A partition is empty if the constraints are constructed
so that no valid element can fulfill them (see example 1). If one or more partitions are empty,
return the String <tt>&quot;EMPTY&quot;</tt>.</li>
<li><i>Overlapping partitions</i>: If there exists a valid element that satisfies
the constraints for two or more partitions (see example 2), return the String
<tt>&quot;OVERLAP&quot;</tt>.</li>
<li><i>Incomplete partitioning</i>: If there exists a valid element that satisfies none
of the constraints (see example 4), return the String <tt>&quot;INCOMPLETE&quot;</tt>.</li>
</ul>

<p>
If several of the criteria above holds for the partitions, return the first that holds (i.e. <tt>&quot;EMPTY&quot;</tt>
has highest priority, followed by <tt>&quot;OVERLAP&quot;</tt> and finally <tt>&quot;INCOMPLETE&quot;</tt>).
</p>

<p>
Otherwise the partitioning is well formed; that is, an arbitrary valid element can
go into exactly one partition and no partition is empty. In this case
you should return the String <tt>&quot;OK&quot;</tt>.
</p>

<p>
Create a class TablePartitions containing the method validate which takes
an int <b>n</b>, the number of columns in the table,
and a String[] <b>partitions</b> containing the constraints
for each partition in the format above. The method should <tt>&quot;EMPTY&quot;</tt>,
<tt>&quot;OVERLAP&quot;</tt>, <tt>&quot;INCOMPLETE&quot;</tt> or <tt>&quot;OK&quot;</tt> (the meanings of these Strings are explained above).
</p></td></tr><tr><td colspan="2" class="statText">&#160;</td></tr><tr><td colspan="2" class="statText"><h3>Definition</h3></td></tr><tr><td class="statText">&#160;&#160;&#160;&#160;</td><td class="statText"><table><tr><td class="statText">Class:</td><td class="statText">TablePartitions</td></tr><tr><td class="statText">Method:</td><td class="statText">validate</td></tr><tr><td class="statText">Parameters:</td><td class="statText">int, String[]</td></tr><tr><td class="statText">Returns:</td><td class="statText">String</td></tr><tr><td class="statText">Method signature:</td><td class="statText">String validate(int n, String[] partitions)</td></tr><tr><td colspan="2" class="statText">(be sure your method is public)</td></tr></table></td></tr><tr><td class="statText">&#160;&#160;&#160;&#160;</td></tr><tr><td class="statText"></td></tr><tr><td colspan="2" class="statText">&#160;</td></tr><tr><td colspan="2" class="statText"><h3>Notes</h3></td></tr><tr><td align="center" valign="top" class="statText">-</td><td class="statText">A partition might have no constraints, meaning that all elements can go into this partition (see example 6).</td></tr><tr><td align="center" valign="top" class="statText">-</td><td class="statText">Remember that the integer fields in a valid element is always between 0 and 100, inclusive.</td></tr><tr><td align="center" valign="top" class="statText">-</td><td class="statText">There can be multiple constraints on the same column in one partition, see example 0.</td></tr><tr><td align="center" valign="top" class="statText">-</td><td class="statText">All quotes around the return Strings above are for clarity only.</td></tr><tr><td colspan="2" class="statText">&#160;</td></tr><tr><td colspan="2" class="statText"><h3>Constraints</h3></td></tr><tr><td align="center" valign="top" class="statText">-</td><td class="statText"><b>n</b> will be between 1 and 8, inclusive.</td></tr><tr><td align="center" valign="top" class="statText">-</td><td class="statText"><b>partitions</b> will contain between 1 and 50 elements, inclusive.</td></tr><tr><td align="center" valign="top" class="statText">-</td><td class="statText">Each element in <b>partitions</b> will contain between 0 and 50 characters, inclusive.</td></tr><tr><td align="center" valign="top" class="statText">-</td><td class="statText">Each element in <b>partitions</b> with more than 0 characters will contain a space separated list of constraints in the format specified above.</td></tr><tr><td align="center" valign="top" class="statText">-</td><td class="statText">There will be no leading or trailing spaces in the elements in <b>partitions</b>.</td></tr><tr><td align="center" valign="top" class="statText">-</td><td class="statText">Each constraint in the elements in <b>partitions</b> will be separated with exactly one space.</td></tr><tr><td colspan="2" class="statText">&#160;</td></tr><tr><td colspan="2" class="statText"><h3>Examples</h3></td></tr><tr><td align="center" nowrap="true" class="statText">0)</td><td class="statText"></td></tr><tr><td class="statText">&#160;&#160;&#160;&#160;</td><td class="statText"><table><tr><td class="statText"><table><tr><td class="statText"><pre>2</pre></td></tr><tr><td class="statText"><pre>{&quot;a&gt;3 a&gt;2&quot;,
 &quot;a&lt;=3 b&gt;5&quot;,
 &quot;b&lt;6 a&lt;=3&quot;}</pre></td></tr></table></td></tr><tr><td class="statText"><pre>Returns: &quot;OK&quot;</pre></td></tr><tr><td class="statText"><table><tr><td colspan="2" class="statText">This is the example in the problem statement with the addition of a redundant constraint in the first partition. This doesn't affect the partitioning though, so the method returns <tt>&quot;OK&quot;</tt> since all elements with <tt>a&gt;3</tt> go into the first partition, while the other two partitions require that <tt>a</tt> is no more than 3 and that <tt>b</tt> is 6 or greater (second partition) or 5 or less (third partition).
</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true" class="statText">1)</td><td class="statText"></td></tr><tr><td class="statText">&#160;&#160;&#160;&#160;</td><td class="statText"><table><tr><td class="statText"><table><tr><td class="statText"><pre>1</pre></td></tr><tr><td class="statText"><pre>{&quot;a=0 a=1&quot;,
 &quot;a&gt;=2&quot;}</pre></td></tr></table></td></tr><tr><td class="statText"><pre>Returns: &quot;EMPTY&quot;</pre></td></tr><tr><td class="statText"><table><tr><td colspan="2" class="statText">The first partition requires that <tt>a</tt> is both 0 and 1 which obviously is a contradiction. Thus no element can go into this partition and therefore it's an empty partition. The method returns <tt>&quot;EMPTY&quot;</tt>.
</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true" class="statText">2)</td><td class="statText"></td></tr><tr><td class="statText">&#160;&#160;&#160;&#160;</td><td class="statText"><table><tr><td class="statText"><table><tr><td class="statText"><pre>2</pre></td></tr><tr><td class="statText"><pre>{&quot;a&gt;=5&quot;,
 &quot;b&lt;=6&quot;}</pre></td></tr></table></td></tr><tr><td class="statText"><pre>Returns: &quot;OVERLAP&quot;</pre></td></tr><tr><td class="statText"><table><tr><td colspan="2" class="statText">The element &quot;a=10, b=0&quot; satisfies the constraints in both partitions, so there clearly is an overlap.
</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true" class="statText">3)</td><td class="statText"></td></tr><tr><td class="statText">&#160;&#160;&#160;&#160;</td><td class="statText"><table><tr><td class="statText"><table><tr><td class="statText"><pre>4</pre></td></tr><tr><td class="statText"><pre>{&quot;d&lt;17 b&lt;40&quot;,
 &quot;d&gt;=17 d&lt;65 b&lt;39&quot;,
 &quot;d&gt;=65 b&lt;39&quot;,
 &quot;d&gt;=17 d&lt;22 b=39&quot;,
 &quot;d&gt;=22 d&lt;47 b=39&quot;,
 &quot;d&gt;=47 b&gt;=39 b&lt;61&quot;,
 &quot;d&lt;9 b&gt;=40 b&lt;61 a&lt;51&quot;,
 &quot;d&lt;9 b&gt;=61 b&lt;89 a&lt;51&quot;,
 &quot;d&lt;28 d&gt;=9 b&gt;=40 b&lt;75 a&lt;=50&quot;,
 &quot;d&lt;28 d&gt;=9 b&gt;=75 b&lt;89 a&lt;=50&quot;,
 &quot;d&gt;=28 d&lt;47 b&gt;=40 b&lt;97&quot;,
 &quot;d&lt;28 b&gt;=89&quot;,
 &quot;d&gt;=28 d&lt;65 b&gt;=97&quot;,
 &quot;d&gt;=47 d&lt;65 b&gt;=61 b&lt;97&quot;,
 &quot;d&gt;=65 d&lt;=100 b&gt;=61&quot;,
 &quot;d&gt;=0 d&lt;28 b&gt;=40 b&lt;89 a&gt;50&quot;}</pre></td></tr></table></td></tr><tr><td class="statText"><pre>Returns: &quot;OK&quot;</pre></td></tr><tr><td class="statText"></td></tr></table></td></tr><tr><td align="center" nowrap="true" class="statText">4)</td><td class="statText"></td></tr><tr><td class="statText">&#160;&#160;&#160;&#160;</td><td class="statText"><table><tr><td class="statText"><table><tr><td class="statText"><pre>4</pre></td></tr><tr><td class="statText"><pre>{&quot;d&lt;17 b&lt;40&quot;,
 &quot;d&gt;=17 d&lt;65 b&lt;39&quot;,
 &quot;d&gt;=65 b&lt;39&quot;,
 &quot;d&gt;=17 d&lt;22 b=39&quot;,
 &quot;d&gt;=22 d&lt;47 b=39&quot;,
 &quot;d&gt;=47 b&gt;=39 b&lt;61&quot;,
 &quot;d&lt;9 b&gt;=40 b&lt;61 a&lt;51&quot;,
 &quot;d&lt;9 b&gt;=61 b&lt;88 a&lt;51&quot;,
 &quot;d&lt;28 d&gt;=9 b&gt;=40 b&lt;75 a&lt;=50&quot;,
 &quot;d&lt;28 d&gt;=9 b&gt;=75 b&lt;89 a&lt;=50&quot;,
 &quot;d&gt;=28 d&lt;47 b&gt;=40 b&lt;97&quot;,
 &quot;d&lt;28 b&gt;=89&quot;,
 &quot;d&gt;=28 d&lt;65 b&gt;=97&quot;,
 &quot;d&gt;=47 d&lt;65 b&gt;=61 b&lt;97&quot;,
 &quot;d&gt;=65 d&lt;=100 b&gt;=61&quot;,
 &quot;d&gt;=0 d&lt;28 b&gt;=40 b&lt;89 a&gt;50&quot;}</pre></td></tr></table></td></tr><tr><td class="statText"><pre>Returns: &quot;INCOMPLETE&quot;</pre></td></tr><tr><td class="statText"><table><tr><td colspan="2" class="statText">Element &quot;a=0, b=88, c=0, d=0&quot; doesn't satisfy any constraint, and there are no overlaps nor empty partitions, so the method returns <tt>&quot;INCOMPLETE&quot;</tt>.
</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true" class="statText">5)</td><td class="statText"></td></tr><tr><td class="statText">&#160;&#160;&#160;&#160;</td><td class="statText"><table><tr><td class="statText"><table><tr><td class="statText"><pre>6</pre></td></tr><tr><td class="statText"><pre>{&quot;&quot;}</pre></td></tr></table></td></tr><tr><td class="statText"><pre>Returns: &quot;OK&quot;</pre></td></tr><tr><td class="statText"></td></tr></table></td></tr></table><hr><p>This problem statement is the exclusive and proprietary property of TopCoder, Inc.  Any unauthorized use or reproduction of this information without the prior written consent of TopCoder, Inc. is strictly prohibited.  (c)2010, TopCoder, Inc.  All rights reserved.  </p>
                      
                   </td>
                 </tr>
                 <tr>
                   <td colspan="7"><img src="/i/clear.gif" alt="" width="1" height="3" border="0"></td>
                 </tr>
                 <tr>
                   <td background="/i/steel_blue_bg.gif" class="statText" colspan="7"><img src="/i/clear.gif" alt="" width="1" height="5" border="0"></td>
                 </tr>
                 <tr>
                   <td class="statText" colspan="7"><img src="/i/clear.gif" alt="" width="1" height="16" border="0"></td>
                 </tr>
                 <tr>
                   <td class="statText" colspan="7">
                      This problem was used for:
   
   	<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="/tc?module=ProblemDetail&rd=5077&pm=2434">2004 TCCC Semifinal Round 2 - Division I, Level Two</a>
   
                   
                   </td>
                 </tr>


               </table>
             </td>
           </tr>
           <tr>
             <td width="100%"><img src="/i/clear.gif" alt="" width="1" height="10" border="0"></td>
           </tr>
         </table>
</body>
</html>
