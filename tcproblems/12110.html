<html>
<head>
<title>Â Problem Statement for PQHulls</title>
</head>
<body>
<table border="0" cellspacing="0" cellpadding="10" width="100%">
           <tr>
             <td valign="top" width="100%"><img src="/i/clear.gif" alt="" width="240" height="1" border="0"><br>
               <table border="0" cellspacing="0" cellpadding="0" width="100%">
                 <tr>
                   <td colspan="7"><img src="/i/clear.gif" alt="" width="1" height="1" border="0"></td>
                 </tr>
                 <tr>
                   <td colspan="7"><img src="/i/clear.gif" alt="" width="1" height="5" border="0"></td>
                 </tr>
                 <tr>
                   
                     <td background="/i/steel_gray_bg.gif" class="statTextBig" colspan="7" height="18">&#160;Problem Statement for PQHulls</td>
                   
                 </tr>
                 <tr>
                   <td colspan="7"><img src="/i/clear.gif" alt="" width="1" height="1" border="0"></td>
                 </tr>
                 <tr>
                   <td colspan="7"><img src="/i/clear.gif" alt="" width="1" height="1" border="0"></td>
                 </tr>
                 <tr>
                   <td class="problemText" valign="middle" align="left">
                      
              		<table><tr><td colspan="2" class="statText"><h3>Problem Statement</h3></td></tr><tr><td class="statText">&#160;&#160;&#160;&#160;</td><td class="statText">You are given ints <b>N</b>, <b>X0</b>, <b>XMul</b>, <b>XAdd</b>, <b>XMod</b>, <b>Y0</b>, <b>YMul</b>, <b>YAdd</b>, <b>YMod</b>. Generate N+2 points (X[0], Y[0]), (X[1], Y[1]), ..., (X[N+1], Y[N+1]) as follows:
<pre>
X[0] = <b>X0</b>,
X[i] = (X[i-1] * <b>XMul</b> + <b>XAdd</b>) % <b>XMod</b>, 0 &lt; i &lt; N+2,
Y[0] = <b>Y0</b>,
Y[i] = (Y[i-1] * <b>YMul</b> + <b>YAdd</b>) % <b>YMod</b>, 0 &lt; i &lt; N+2.
</pre>
You can assume that no two of those N+2 points will coincide and no 3 points will lie on the same straight line.
<br><br>
Let S be the set of points 0-th to (N-1)-th, P be the N-th point and Q be the (N+1)-th point. In other words, S = {(X[0], Y[0]), (X[1], Y[1]), ..., (X[N-1], Y[N-1])}, P = (X[N], Y[N]) and Q = (X[N+1], Y[N+1]). A subset T of points from S is called <i>nice</i> if:
<ul>
<li>It contains at least 3 points.</li>
<li>The convex hull of points from T contains both P and Q inside itself. (See notes for the definition of "convex hull".)</li>
</ul>
Return the number of nice subsets, modulo 1,000,000,007.</td></tr><tr><td colspan="2" class="statText">&#160;</td></tr><tr><td colspan="2" class="statText"><h3>Definition</h3></td></tr><tr><td class="statText">&#160;&#160;&#160;&#160;</td><td class="statText"><table><tr><td class="statText">Class:</td><td class="statText">PQHulls</td></tr><tr><td class="statText">Method:</td><td class="statText">countSubsets</td></tr><tr><td class="statText">Parameters:</td><td class="statText">int, int, int, int, int, int, int, int, int</td></tr><tr><td class="statText">Returns:</td><td class="statText">int</td></tr><tr><td class="statText">Method signature:</td><td class="statText">int countSubsets(int N, int X0, int XMul, int XAdd, int XMod, int Y0, int YMul, int YAdd, int YMod)</td></tr><tr><td colspan="2" class="statText">(be sure your method is public)</td></tr></table></td></tr><tr><td class="statText">&#160;&#160;&#160;&#160;</td></tr><tr><td class="statText"></td></tr><tr><td colspan="2" class="statText">&#160;</td></tr><tr><td colspan="2" class="statText"><h3>Notes</h3></td></tr><tr><td align="center" valign="top" class="statText">-</td><td class="statText">A set of points A is called <i>convex</i> if for any two points p1 and p2 from A, all points of the line segment p1-p2 also belong to A.</td></tr><tr><td align="center" valign="top" class="statText">-</td><td class="statText">A polygon is called <i>convex</i> if its interior is a convex set.</td></tr><tr><td align="center" valign="top" class="statText">-</td><td class="statText">A set S is called <i>minimal</i> with respect to a certain property, if this property is true for S, but false for any proper subset of S.</td></tr><tr><td align="center" valign="top" class="statText">-</td><td class="statText">The <i>convex hull</i> of a set of points A is the minimal convex set that contains all points from A. The convex hull can be shown to be a convex polygon with all vertices being points from A.</td></tr><tr><td colspan="2" class="statText">&#160;</td></tr><tr><td colspan="2" class="statText"><h3>Constraints</h3></td></tr><tr><td align="center" valign="top" class="statText">-</td><td class="statText"><b>N</b> will be between 3 and 2,000, inclusive.</td></tr><tr><td align="center" valign="top" class="statText">-</td><td class="statText"><b>XMod</b> and <b>YMod</b> will each be between 1 and 100,000,000, inclusive.</td></tr><tr><td align="center" valign="top" class="statText">-</td><td class="statText"><b>X0</b>, <b>XMul</b> and <b>XAdd</b> will each be between 0 and <b>XMod</b>-1, inclusive.</td></tr><tr><td align="center" valign="top" class="statText">-</td><td class="statText"><b>Y0</b>, <b>YMul</b> and <b>YAdd</b> will each be between 0 and <b>YMod</b>-1, inclusive.</td></tr><tr><td align="center" valign="top" class="statText">-</td><td class="statText">No two of the N+2 points (generated as described in the problem statement) will occupy the exact same place.</td></tr><tr><td align="center" valign="top" class="statText">-</td><td class="statText">No three of the N+2 points (generated as described in the problem statement) will lie on the same straight line.</td></tr><tr><td colspan="2" class="statText">&#160;</td></tr><tr><td colspan="2" class="statText"><h3>Examples</h3></td></tr><tr><td align="center" nowrap="true" class="statText">0)</td><td class="statText"></td></tr><tr><td class="statText">&#160;&#160;&#160;&#160;</td><td class="statText"><table><tr><td class="statText"><table><tr><td class="statText"><pre>4</pre></td></tr><tr><td class="statText"><pre>3</pre></td></tr><tr><td class="statText"><pre>3</pre></td></tr><tr><td class="statText"><pre>3</pre></td></tr><tr><td class="statText"><pre>10</pre></td></tr><tr><td class="statText"><pre>0</pre></td></tr><tr><td class="statText"><pre>3</pre></td></tr><tr><td class="statText"><pre>2</pre></td></tr><tr><td class="statText"><pre>7</pre></td></tr></table></td></tr><tr><td class="statText"><pre>Returns: 3</pre></td></tr><tr><td class="statText"><table><tr><td colspan="2" class="statText">S = {(3, 0), (2, 2), (9, 1), (0, 5)}. P = (3, 3). Q = (2, 4).
<br><br>
<img src="http://community.topcoder.com/contest/problem/PQHulls/pic1.png">
<br><br>
A nice subset needs to contain points 2 and 3 and least one of points 0 and 1.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true" class="statText">1)</td><td class="statText"></td></tr><tr><td class="statText">&#160;&#160;&#160;&#160;</td><td class="statText"><table><tr><td class="statText"><table><tr><td class="statText"><pre>5</pre></td></tr><tr><td class="statText"><pre>1</pre></td></tr><tr><td class="statText"><pre>5</pre></td></tr><tr><td class="statText"><pre>6</pre></td></tr><tr><td class="statText"><pre>8</pre></td></tr><tr><td class="statText"><pre>5</pre></td></tr><tr><td class="statText"><pre>5</pre></td></tr><tr><td class="statText"><pre>3</pre></td></tr><tr><td class="statText"><pre>9</pre></td></tr></table></td></tr><tr><td class="statText"><pre>Returns: 5</pre></td></tr><tr><td class="statText"><table><tr><td colspan="2" class="statText">S = {(1, 5), (3, 1), (5, 8), (7, 7), (1, 2)}. P = (3, 4). Q = (5, 5).
<br><br>
<img src="http://community.topcoder.com/contest/problem/PQHulls/pic2.png">
<br><br>
4 nice subsets can be obtained by taking points 0, 1 and 3, and by optionally adding each of the points 2 and 4 to them. One more nice subset consists of points 1, 2, 3 and 4.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true" class="statText">2)</td><td class="statText"></td></tr><tr><td class="statText">&#160;&#160;&#160;&#160;</td><td class="statText"><table><tr><td class="statText"><table><tr><td class="statText"><pre>5</pre></td></tr><tr><td class="statText"><pre>4</pre></td></tr><tr><td class="statText"><pre>1</pre></td></tr><tr><td class="statText"><pre>1</pre></td></tr><tr><td class="statText"><pre>8</pre></td></tr><tr><td class="statText"><pre>5</pre></td></tr><tr><td class="statText"><pre>4</pre></td></tr><tr><td class="statText"><pre>4</pre></td></tr><tr><td class="statText"><pre>6</pre></td></tr></table></td></tr><tr><td class="statText"><pre>Returns: 0</pre></td></tr><tr><td class="statText"><table><tr><td colspan="2" class="statText">There can be no nice subsets.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true" class="statText">3)</td><td class="statText"></td></tr><tr><td class="statText">&#160;&#160;&#160;&#160;</td><td class="statText"><table><tr><td class="statText"><table><tr><td class="statText"><pre>99</pre></td></tr><tr><td class="statText"><pre>9461448</pre></td></tr><tr><td class="statText"><pre>38301228</pre></td></tr><tr><td class="statText"><pre>33476602</pre></td></tr><tr><td class="statText"><pre>42996440</pre></td></tr><tr><td class="statText"><pre>10502745</pre></td></tr><tr><td class="statText"><pre>35649230</pre></td></tr><tr><td class="statText"><pre>12271470</pre></td></tr><tr><td class="statText"><pre>65500929</pre></td></tr></table></td></tr><tr><td class="statText"><pre>Returns: 181248946</pre></td></tr><tr><td class="statText"><table><tr><td colspan="2" class="statText"></td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true" class="statText">4)</td><td class="statText"></td></tr><tr><td class="statText">&#160;&#160;&#160;&#160;</td><td class="statText"><table><tr><td class="statText"><table><tr><td class="statText"><pre>2000</pre></td></tr><tr><td class="statText"><pre>6927240</pre></td></tr><tr><td class="statText"><pre>2020343</pre></td></tr><tr><td class="statText"><pre>10323527</pre></td></tr><tr><td class="statText"><pre>10690663</pre></td></tr><tr><td class="statText"><pre>28749177</pre></td></tr><tr><td class="statText"><pre>29744699</pre></td></tr><tr><td class="statText"><pre>60134478</pre></td></tr><tr><td class="statText"><pre>78767213</pre></td></tr></table></td></tr><tr><td class="statText"><pre>Returns: 143010383</pre></td></tr><tr><td class="statText"><table><tr><td colspan="2" class="statText"></td></tr></table></td></tr></table></td></tr></table><hr><p>This problem statement is the exclusive and proprietary property of TopCoder, Inc.  Any unauthorized use or reproduction of this information without the prior written consent of TopCoder, Inc. is strictly prohibited.  (c)2010, TopCoder, Inc.  All rights reserved.  </p>
                      
                   </td>
                 </tr>
                 <tr>
                   <td colspan="7"><img src="/i/clear.gif" alt="" width="1" height="3" border="0"></td>
                 </tr>
                 <tr>
                   <td background="/i/steel_blue_bg.gif" class="statText" colspan="7"><img src="/i/clear.gif" alt="" width="1" height="5" border="0"></td>
                 </tr>
                 <tr>
                   <td class="statText" colspan="7"><img src="/i/clear.gif" alt="" width="1" height="16" border="0"></td>
                 </tr>
                 <tr>
                   <td class="statText" colspan="7">
                      This problem was used for:
   
   	<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="/tc?module=ProblemDetail&rd=15097&pm=12110">2012 TCO Algorithm Round 3B - Division I, Level Three</a>
   
   	<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="/tc?module=ProblemDetail&rd=15304&pm=12110">2012 TCO Algorithm Parallel Round 3B - Division I, Level Three</a>
   
                   
                   </td>
                 </tr>


               </table>
             </td>
           </tr>
           <tr>
             <td width="100%"><img src="/i/clear.gif" alt="" width="1" height="10" border="0"></td>
           </tr>
         </table>
</body>
</html>
