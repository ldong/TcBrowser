<html>
<head>
<title>Â Problem Statement for Pikachu</title>
</head>
<body>
<table border="0" cellspacing="0" cellpadding="10" width="100%">
           <tr>
             <td valign="top" width="100%"><img src="/i/clear.gif" alt="" width="240" height="1" border="0"><br>
               <table border="0" cellspacing="0" cellpadding="0" width="100%">
                 <tr>
                   <td colspan="7"><img src="/i/clear.gif" alt="" width="1" height="1" border="0"></td>
                 </tr>
                 <tr>
                   <td colspan="7"><img src="/i/clear.gif" alt="" width="1" height="5" border="0"></td>
                 </tr>
                 <tr>
                   
                     <td background="/i/steel_gray_bg.gif" class="statTextBig" colspan="7" height="18">&#160;Problem Statement for Pikachu</td>
                   
                 </tr>
                 <tr>
                   <td colspan="7"><img src="/i/clear.gif" alt="" width="1" height="1" border="0"></td>
                 </tr>
                 <tr>
                   <td colspan="7"><img src="/i/clear.gif" alt="" width="1" height="1" border="0"></td>
                 </tr>
                 <tr>
                   <td class="problemText" valign="middle" align="left">
                      
              		<table><tr><td colspan="2" class="statText"><h3>Problem Statement</h3></td></tr><tr><td class="statText">&#160;&#160;&#160;&#160;</td><td class="statText">Pikachu is a well-known character in the Pokemon anime series.
Pikachu can speak, but only 3 syllables: "pi", "ka", and "chu".
Therefore Pikachu can only pronounce strings that can be created as a concatenation of one or more syllables he can pronounce.
For example, he can pronounce the words "pikapi" and "pikachu".
<br>
<br>
<br>
We need to teach our Pikachu to use N different words, conveniently numbered 0 through N-1.
To do this, we need to encode the words into N distinct strings Pikachu will be able to pronounce.
For example, we may encode "electric" as "pikapi" and "mouse" as "pikachu".
As Pikachu sometimes omits pauses between the words he says, the encoding we will use must be prefix-free.
More formally, we need to choose strings code[0], code[1], ..., code[N-1] such that:
<ol>
<li>For any i, code[i] must be a string that is generated by concatenating one or more copies of the strings "pi", "ka" and "chu".</li>
<li>For any distinct i and j, code[i] is not a prefix of code[j].</li>
</ol>
Of course, there are infinitely many such codes.
We want you to find all the most efficient codes.
The N words we need to encode may have distinct frequencies.
You are given the relative frequences of all words as a int[] <b>freq</b>.
(I.e., the actual frequency of the i-th word is <b>freq</b>[i]/S, where S is the sum of all elements of <b>freq</b>.)
For a given code, its total cost can be computed as the sum of (<b>freq</b>[i]*length(code[i])) over all i.
<br>
<br>
<br>
Let A be the minimal total cost that can be achieved, 
and let B be the number of distinct codes that have the total cost equal to A.
Your method must return a int[] with two elements:
element 0 should be the value A, and element 1 should be the value (B modulo 1,000,000,009).</td></tr><tr><td colspan="2" class="statText">&#160;</td></tr><tr><td colspan="2" class="statText"><h3>Definition</h3></td></tr><tr><td class="statText">&#160;&#160;&#160;&#160;</td><td class="statText"><table><tr><td class="statText">Class:</td><td class="statText">Pikachu</td></tr><tr><td class="statText">Method:</td><td class="statText">bestEncoding</td></tr><tr><td class="statText">Parameters:</td><td class="statText">int[]</td></tr><tr><td class="statText">Returns:</td><td class="statText">int[]</td></tr><tr><td class="statText">Method signature:</td><td class="statText">int[] bestEncoding(int[] freq)</td></tr><tr><td colspan="2" class="statText">(be sure your method is public)</td></tr></table></td></tr><tr><td class="statText">&#160;&#160;&#160;&#160;</td></tr><tr><td class="statText"></td></tr><tr><td colspan="2" class="statText">&#160;</td></tr><tr><td colspan="2" class="statText"><h3>Constraints</h3></td></tr><tr><td align="center" valign="top" class="statText">-</td><td class="statText"><b>freq</b> will contain between 2 and 30 elements, inclusive.</td></tr><tr><td align="center" valign="top" class="statText">-</td><td class="statText">Each element of <b>freq</b> will be between 1 and 1000, inclusive.</td></tr><tr><td colspan="2" class="statText">&#160;</td></tr><tr><td colspan="2" class="statText"><h3>Examples</h3></td></tr><tr><td align="center" nowrap="true" class="statText">0)</td><td class="statText"></td></tr><tr><td class="statText">&#160;&#160;&#160;&#160;</td><td class="statText"><table><tr><td class="statText"><table><tr><td class="statText"><pre>{1,1}</pre></td></tr></table></td></tr><tr><td class="statText"><pre>Returns: {4, 2 }</pre></td></tr><tr><td class="statText"><table><tr><td colspan="2" class="statText">We have two words with the same frequency.
One of the two optimal codes is ("pi", "ka"), i.e., word 0 is encoded as "pi" and word 1 is encoded as "ka".
The total cost of this code is 1*length("pi") + 1*length("ka") = 1*2 + 1*2 = 4.
The other optimal code is ("ka", "pi").</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true" class="statText">1)</td><td class="statText"></td></tr><tr><td class="statText">&#160;&#160;&#160;&#160;</td><td class="statText"><table><tr><td class="statText"><table><tr><td class="statText"><pre>{1,1,2}</pre></td></tr></table></td></tr><tr><td class="statText"><pre>Returns: {9, 4 }</pre></td></tr><tr><td class="statText"><table><tr><td colspan="2" class="statText">There are 4 solutions:
<br>
("chu", "ka", "pi"), ("ka", "chu", "pi"), ("pi", "chu", "ka") and ("chu", "pi", "ka").
<br>
Note that solutions that encode word 2 as "chu" are not optimal.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true" class="statText">2)</td><td class="statText"></td></tr><tr><td class="statText">&#160;&#160;&#160;&#160;</td><td class="statText"><table><tr><td class="statText"><table><tr><td class="statText"><pre>{1,1,1,1}</pre></td></tr></table></td></tr><tr><td class="statText"><pre>Returns: {13, 48 }</pre></td></tr><tr><td class="statText"><table><tr><td colspan="2" class="statText">One of the 48 optimal codes is ("pi", "chu", "kapi", "kaka").</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true" class="statText">3)</td><td class="statText"></td></tr><tr><td class="statText">&#160;&#160;&#160;&#160;</td><td class="statText"><table><tr><td class="statText"><table><tr><td class="statText"><pre>{2,3,5,7,11,13,17,19}</pre></td></tr></table></td></tr><tr><td class="statText"><pre>Returns: {309, 96 }</pre></td></tr><tr><td class="statText"><table><tr><td colspan="2" class="statText"></td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true" class="statText">4)</td><td class="statText"></td></tr><tr><td class="statText">&#160;&#160;&#160;&#160;</td><td class="statText"><table><tr><td class="statText"><table><tr><td class="statText"><pre>{533,533,533,353,335,335}</pre></td></tr></table></td></tr><tr><td class="statText"><pre>Returns: {10290, 288 }</pre></td></tr><tr><td class="statText"><table><tr><td colspan="2" class="statText"></td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true" class="statText">5)</td><td class="statText"></td></tr><tr><td class="statText">&#160;&#160;&#160;&#160;</td><td class="statText"><table><tr><td class="statText"><table><tr><td class="statText"><pre>{1,1,1,1,1,1,1,1,1,1,1,1,1}</pre></td></tr></table></td></tr><tr><td class="statText"><pre>Returns: {72, 362124467 }</pre></td></tr><tr><td class="statText"><table><tr><td colspan="2" class="statText">Don't forget to use modular arithmetics when computing B.</td></tr></table></td></tr></table></td></tr></table><hr><p>This problem statement is the exclusive and proprietary property of TopCoder, Inc.  Any unauthorized use or reproduction of this information without the prior written consent of TopCoder, Inc. is strictly prohibited.  (c)2010, TopCoder, Inc.  All rights reserved.  </p>
                      
                   </td>
                 </tr>
                 <tr>
                   <td colspan="7"><img src="/i/clear.gif" alt="" width="1" height="3" border="0"></td>
                 </tr>
                 <tr>
                   <td background="/i/steel_blue_bg.gif" class="statText" colspan="7"><img src="/i/clear.gif" alt="" width="1" height="5" border="0"></td>
                 </tr>
                 <tr>
                   <td class="statText" colspan="7"><img src="/i/clear.gif" alt="" width="1" height="16" border="0"></td>
                 </tr>
                 <tr>
                   <td class="statText" colspan="7">
                      This problem was used for:
   
   	<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="/tc?module=ProblemDetail&rd=14726&pm=11779">Single Round Match 533 Round 1 - Division I, Level Three</a>
   
                   
                   </td>
                 </tr>


               </table>
             </td>
           </tr>
           <tr>
             <td width="100%"><img src="/i/clear.gif" alt="" width="1" height="10" border="0"></td>
           </tr>
         </table>
</body>
</html>
